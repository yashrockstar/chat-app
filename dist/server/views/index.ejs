<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Chat App</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
    />
    <style>
      .main {
        margin-left: 600px;
        margin-top: 40px;
        align-items: center;
        border-radius: 21px;
        background-color: rgb(241, 239, 236);
        border: 2px solid black;
        height: 850px;
        width: 600px;
      }

      .arrow {
        margin-left: 30px;
        margin-top: 20px;
      }

      .left {
        width: 56px;
        height: 20px;
        background-color: gray;
        border-radius: 12px;
        margin-left: 20px;
        margin-top: 20px;
        text-align: center;
      }
      .side {
        width: 36px;
        height: 20px;
        background-color: gray;
        border-radius: 12px;
        margin-left: 200px;
        margin-top: 20px;
        text-align: center;
      }

      .heading {
        display: flex;
      }

      .text {
        margin-left: 35px;
      }

      .six {
        margin-left: 80px;
      }

      .sec {
        display: flex;
        margin-top: -9px;
      }

      .sign {
        margin-left: 30px;
      }

      .seven {
        margin-left: 30px;
      }

      .dot {
        margin-left: 270px;
      }

      .third {
        display: flex;
        margin-top: -40px;
      }

      .mess {
        margin-left: 35px;
        background-color: gray;
        border-radius: 12px;
        width: 270px;
      }

      .reply {
        margin-top: 15px;
        background-color: wheat;
        margin-left: 380px;
        width: 170px;
        height: 20px;
        border-radius: 12px;
      }

      .last {
        margin-left: 35px;
        background-color: gray;
        border-radius: 12px;
        width: 220px;
        height: 160px;
        margin-top: 18px;
      }

      .pizza {
        margin-left: 20px;
        margin-top: -10px;
        background-color: aliceblue;
        width: 120px;
        border-radius: 16px;
      }

      .burger {
        margin-left: 20px;
        margin-top: -10px;
        background-color: aliceblue;
        width: 120px;
        border-radius: 10px;
      }

      .send {
        background-color: gray;
        height: 90px;
        width: 570px;
        margin-left: 12px;
        margin-top: -25px;
        border-radius: 12px;
      }

      .plus {
        color: gray;
        height: 35px;
        width: 35px;
        background-color: white;
        text-align: center;
        margin-left: 20px;
        font-size: 30px;
        border-radius: 8px;
        margin-top: -16px;
      }

      .black {
        color: white;
        height: 35px;
        width: 130px;
        text-align: center;
        margin-left: 470px;
        margin-top: 20px;
        border-radius: 5px;
      }

      .play {
        margin-top: 15px;
        background-color: wheat;
        margin-left: 380px;
        width: 170px;
        height: 35px;
        border-radius: 12px;
        display: flex;
      }

      .img {
        border-radius: 50%;
        height: 10px;
        width: 20px;
      }

      .img .card-img {
        width: 35px;
        border-radius: 50%;
        margin-left: 5px;
      }

      .material-symbols-outlined {
        text-align: center;
        font-size: 50px;
        margin-left: 280px;
        margin-top: 90px;
      }

      .messages {
        height: 650px;
        overflow-y: scroll;
      }

      ::-webkit-input-placeholder {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="main">
      <div class="heading">
        <h3 class="text">Anonymous Chat App</h3>
      </div>

      <hr style="margin-top: -5px" />
      <div class="messages">
        <p style="text-align: center; font-style: oblique">
          Introduce yourself anonymously in one line and enjoy chatting with
          many other anonymous people ...
        </p>
        <hr />
        <h4 style="text-align: center" id="time_now"></h4>
      </div>

      <div
        class="send"
        style="display: flex; position: fixed; bottom: 0; margin-bottom: 80px"
      >
        <input
          id="text"
          placeholder="Type your message"
          style="
            width: 460px;
            margin-left: 15px;
            height: 50px;
            margin-top: 15px;
            border-radius: 12px;
          "
        />
        <div style="padding-top: 10px; margin-left: 20px" id="message_send">
          <i
            class="fa fa-2x fa-paper-plane"
            style="color: aliceblue; margin-top: 20px"
            onMouseOver="this.style.color='wheat'; this.style.cursor='pointer';"
            onMouseOut="this.style.color='aliceblue'"
            aria-hidden="true"
          ></i>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script>
      $(document).ready(function () {
        $("#time_now").text(moment().format("llll"));
      });

      var socket = new WebSocket("wss://anonymous-chat-app.onrender.com/", "a");
      socket.onopen = function () {
        console.log("inside onopen");
        if (socket.readyState === 1) {
          console.log("connection established");
        }
      };
      socket.onmessage = function (e) {
        var html = `<div style="display: flex; margin-top: 3px;">
          <div class="img" style="margin-top: 5px">
            <img
              src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTuSosG1ERwsITqkXpEd89Xq001RZZziQRMQQ&usqp=CAU"
              alt=""
              class="card-img"
            />
          </div>
          <div class="mess">
            <h4 style="margin: 13px; font-family: 'Brush Script MT', cursive; font-weight: lighter;">
              ${e.data}
            </h4>
          </div>
        </div>`;
        $(".messages").append(html);
        $(".messages").animate(
          {
            scrollTop:
              $(".messages").prop("scrollHeight") - $(".messages").height(),
          },
          "fast"
        );
      };
      socket.onclose = function () {};
      socket.onerror = function () {};

      $("#message_send").on("click", function (e) {
        if ($("#text").val() != null && $("#text").val() != "") {
          socket.send($("#text").val());
          $("#text").val("");
        }
      });

      $(document).on("keypress", function (e) {
        if (e.which == 13) {
          if ($("#text").val() != null && $("#text").val() != "") {
            socket.send($("#text").val());
            $("#text").val("");
          }
        }
      });
    </script>
  </body>
</html>
